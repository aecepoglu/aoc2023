Padâ†{ð•¨(âˆ¾âˆ¾âŠ£)Ë˜(ð•¨Â¨âŠ)âŠ¸(âˆ¾âˆ¾âŠ£)ð•©}
dâ†â†•4 # N E S W
uâ†âŸ¨Â¯1â€¿0, 0â€¿1, 1â€¿0, 0â€¿Â¯1âŸ©
p1â†"nesw"âŠ["    ", # .
           "e  s", # F
           "ws  ", # 7
           " nw ", # J
           "  en", # L
           "n s ", # |
           " e w"] # -
p2â†[ 0â€¿0â€¿0â€¿0   # â€¿
   , 0â€¿1â€¿1â€¿0   # â”Œ
   , 0â€¿0â€¿1â€¿1   # â”
   , 1â€¿0â€¿0â€¿1   # â”˜
   , 1â€¿1â€¿0â€¿0   # â””
   , 1â€¿0â€¿1â€¿0   # â”‚
   , 0â€¿1â€¿0â€¿1 ] # â”€
NoSâ†{ð•Šdata:
 mâ†".F7JL|-S"âŠ data
   #01234567
 mâŠ" â”Œâ”â”˜â””â”‚â”€S"
 i_sâ†âŠ‘(/âˆ˜â¥Š(âŒŠâˆ˜Ã·â‹ˆÂ¨|Ëœ)â‰ âˆ˜âŠ)7=m
 (mâŠ‘Ëœi_sâŠ¸+Â¨u)âŠË˜(â‰4>p1) # which ways i_s can go
 i0â€¿d0â†âŠ‘Â¨ Â·â€¿d0sâ†{(/âŸœð•©â‹ˆ/)(â‰4>p1)âŠË˜Ëœð•©âŠ‘m}i_sâŠ¸+Â¨u
       # replace 'S' with the shape
 i_s â‹ˆ (âŠ‘/(âˆ§Â´d0sâŠ¸âˆŠ)Ë˜p1)âŒ¾(i_sâŠ¸âŠ‘) m
}

Travelâ†{i_sð•Šm:
 'X'âŒ¾(i_sâŠ¸âŠ‘) âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S" m
 d0sâ†/(i_sâŠ‘m)âŠp2
 i0â€¿d0â†âŠ‘d0sâ‹ˆÂ¨Ëœi_sâŠ¸+Â¨d0sâŠu
 # i: my position
 # d: my direction (where I've entered pos i from)
 Fâ†{ð•Šiâ€¿d:(i+âŠ‘âŸœu)âŠ¸â‹ˆ p1âŠ‘Ëœ dâ‹ˆËœiâŠ‘m}
 FâŸ(â†•Ã—Â´â‰¢m) i0â€¿d0 # part 1
} 
Solveâ†{ð•Šdata:
 iâ€¿mâ†NoS data
 2Ã·Ëœ1âŠ‘/ âˆŠâŸœ(1âŠ¸â†‘) i Travel m
}

4 = Solve [".....",".S-7.",".|.|.",".L-J.","....."]
8 = Solve dataâ†["..F7.", ".FJ|.", "SJ.L7", "|F--J", "LJ..."]
# Part 1
â€¢Show "part1"â‹ˆ Solve >â€¢FLines "input.txt"

rightâ€¿downâ†âˆ¨Â´Â¨Â¨(1âŠ¸=â‹ˆ2âŠ¸=)/Â¨(âˆ§âŸœ(2âŠ¸âŒ½)â—‹(âŠâŸœp2))âŒœËœâ†•7
Widenâ†{kâ€¿að•Šð•©:((Â·â¥Š2âŠ¸â†‘Ë˜)âˆ¾Â¯1â€¿Â¯1âŠ¸âŠ‘) (âŠ‘(âŠ£âˆ¾(kÃ—â‹ˆâŠ‘aË™)âˆ¾âŠ¢)1âŠ¸âŠ‘)Ë˜2â†•ð•©}
Shrinkâ†(0=2|â†•âˆ˜â‰ )âŠ¸/
Unpadâ†1â†“ Â¯1â†“ (Â¯1â†“1â†“âŠ¢)Ë˜
Grwâ†{2ð•Š1:1; 2ð•ŠÂ·:2; ð•©}
# âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S" m
# âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S" WidenË˜m
# mâ‰¡Shrinkâˆ˜WidenË˜m
Solve2â†{ð•Šdata:
 i0â€¿m0â†NoS data
 mcâ†m0 Ã—(â·âŠ‘Â¨i0 Travel m0) âˆŠËœ â†•â‰¢m0
 âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S" mâ†0 Pad 5â€¿downâŠ¸WidenË˜âŒ¾(âŒ½â‰) 6â€¿rightâŠ¸WidenË˜mc
 âŠâŸœ".#/" finâ†ShrinkË˜âŒ¾â‰ ShrinkË˜Unpad finbâ†(âŒ½âˆ˜â‰Grw`Ë˜)âŸ200 2âŒ¾(0â€¿0âŠ¸âŠ‘) 0â‰ m
 # âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S#" m0+8Ã—0= ShrinkË˜âŒ¾â‰ ShrinkË˜Unpad finb
 # â€¢OutË˜âŠâŸœ" â”Œâ”â”˜â””â”‚â”€S#" (ShrinkË˜âŒ¾â‰ ShrinkË˜Unpad m)+8Ã—0=fin
 +Â´0=â¥Šfin
}

Solve2v2â†{ð•Šdata:
 i0â€¿m0â†NoS data
 mcâ†m0 Ã—(â·âŠ‘Â¨i0 Travel m0) âˆŠËœ â†•â‰¢m0
 snapâ†â· i0 Travel mc
 duvdâ†(1âŠ¸âŠ‘Â¨snap)âŒ¾((âŠ‘Â¨snap)âŠ¸âŠ‘) 5Â¨mc
 +Â´â¥Š(0=mc)âˆ§2=({ð•¨ð•Š5:ð•¨;ð•©}`âŒ¾âŒ½)Ë˜duvd
}
smplâ†["...........",
      ".S-------7.",
      ".|F-----7|.",
      ".||.F.L.||.",
      ".||.....||.",
      ".|L--7F-J|.",
      ".|.|.||..|.",
      ".L---JL--J.",
      "..........."]

5=Solve2 smpl
5=Solve2v2 smpl
â€¢Show "part2" â‹ˆ Solve2   >â€¢FLines "input.txt"
â€¢Show "part2" â‹ˆ Solve2v2 >â€¢FLines "input.txt"

